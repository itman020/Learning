Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
Sub start_Click()
start
End Sub

Function start()
'MsgBox ("hello")
Dim iExit

Dim dWinFolder As New ShellWindows
'May cause User-defined type not defined, please add lib
' Tool|References,select "Microsoft Internet Control"

Dim IE As Object
Dim objIE As Object
'Element ID / Element value
'5-element 1,6-element 2,...
Dim e1V, e2V, e3V, e4V, e5V, e6V, e7V, e9V, exV
Dim e1ID, e2ID, e3ID, e4ID, e5ID, e6ID, e7ID, e8ID, e9ID, exID
'Commont value
'1-sequence,
'   2-eType,3-url,4-domian
Dim eType, iEURL, iEDomain, iDlen

iEURL = ThisWorkbook.Sheets("Value").Cells(1, 3)
iEDomain = ThisWorkbook.Sheets("Value").Cells(1, 4)
iDlen = Len(iEDomain)
'Element ID / Element value
'E1
e1ID = ThisWorkbook.Sheets("ID").Cells(1, 5)
e1V = ThisWorkbook.Sheets("Value").Cells(1, 5)
' E2
e2ID = ThisWorkbook.Sheets("ID").Cells(1, 6)

Set IE = CreateObject("InternetExplorer.Application")
IE.Visible = True

'IE.Navigate ("https://gd.ac.10086.cn/ucs/login/signup.jsps")
IE.Navigate (iEURL)
Sleep 10000 'sleep to open the url incase it loading too long due to slow response

For Each objIE In dWinFolder  '01 Loop
  Do While InStr(1, objIE.FullName, "IEXPLORE.EXE", vbTextCompare) <> 0 '02 Loop
    iExit = iExit + 1 ' count to exit loop, maybe it slow response
    'domain longth
    
    If Left(objIE.LocationURL, iDlen) = iEDomain Then
      Set objDoc = objIE.Document
      On Error Resume Next
      'abc = waitPro(objDoc, "mobile")
      'objDoc.getelementbyid("mobile").innerText = e1V
      'Sleep 1000
      'objDoc.getelementbyid("btn_get_dpw").Click
      
      abc = waitPro(objDoc, e1ID)
      objDoc.getelementbyid(e1ID).innerText = e1V
      Sleep 1000
      objDoc.getelementbyid(e2ID).Click
      Exit Do
    End If
    If iExit > 10 Then
      Exit Do
    End If
  Loop 'End 02:Do While
Next 'End 01: For Each objIE In dWinFolder

'Close browser
Sleep 10000
IE.Quit

End Function

Function waitPro(objDoc, name)
    Dim i
    i = 0
    Do While i < 10
    On Error Resume Next
    If objDoc.getelementbyid(name) = Null Then
       Sleep 500
    Else
       Exit Do
    
    End If
    i = i + 1
    Loop
End Function

